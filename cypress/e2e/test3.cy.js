const inputData = [
    {
      "beatsPerMinute": 73,
      "timestamps": {
        "startTime": "2023-04-30T20:41:00",
        "endTime": "2023-04-30T20:41:00"
      }
    },
    {
        "beatsPerMinute": 67,
        "timestamps": {
          "startTime": "2023-05-01T09:38:00",
          "endTime": "2023-05-01T09:38:00"
        }
      },
      {
        "beatsPerMinute": 78,
        "timestamps": {
          "startTime": "2023-05-01T09:41:00",
          "endTime": "2023-05-01T09:41:00"
        }
      },
      {
        "beatsPerMinute": 60,
        "timestamps": {
          "startTime": "2023-05-01T09:46:00",
          "endTime": "2023-05-01T09:46:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T09:49:00",
          "endTime": "2023-05-01T09:49:00"
        }
      },
      {
        "beatsPerMinute": 64,
        "timestamps": {
          "startTime": "2023-05-01T09:59:00",
          "endTime": "2023-05-01T09:59:00"
        }
      },
      {
        "beatsPerMinute": 66,
        "timestamps": {
          "startTime": "2023-05-01T10:05:00",
          "endTime": "2023-05-01T10:05:00"
        }
      },
      {
        "beatsPerMinute": 69,
        "timestamps": {
          "startTime": "2023-05-01T10:13:00",
          "endTime": "2023-05-01T10:13:00"
        }
      },
      {
        "beatsPerMinute": 61,
        "timestamps": {
          "startTime": "2023-05-01T10:21:00",
          "endTime": "2023-05-01T10:21:00"
        }
      },
      {
        "beatsPerMinute": 79,
        "timestamps": {
          "startTime": "2023-05-01T10:24:00",
          "endTime": "2023-05-01T10:24:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T10:29:00",
          "endTime": "2023-05-01T10:29:00"
        }
      },
      {
        "beatsPerMinute": 79,
        "timestamps": {
          "startTime": "2023-05-01T10:37:00",
          "endTime": "2023-05-01T10:37:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T10:42:00",
          "endTime": "2023-05-01T10:42:00"
        }
      },
      {
        "beatsPerMinute": 67,
        "timestamps": {
          "startTime": "2023-05-01T10:49:00",
          "endTime": "2023-05-01T10:49:00"
        }
      },
      {
        "beatsPerMinute": 72,
        "timestamps": {
          "startTime": "2023-05-01T10:57:00",
          "endTime": "2023-05-01T10:57:00"
        }
      },
      {
        "beatsPerMinute": 104,
        "timestamps": {
          "startTime": "2023-05-01T11:04:00",
          "endTime": "2023-05-01T11:04:00"
        }
      },
      {
        "beatsPerMinute": 98,
        "timestamps": {
          "startTime": "2023-05-01T11:07:00",
          "endTime": "2023-05-01T11:07:00"
        }
      },
      {
        "beatsPerMinute": 92,
        "timestamps": {
          "startTime": "2023-05-01T11:12:00",
          "endTime": "2023-05-01T11:12:00"
        }
      },
      {
        "beatsPerMinute": 112,
        "timestamps": {
          "startTime": "2023-05-01T11:22:00",
          "endTime": "2023-05-01T11:22:00"
        }
      },
      {
        "beatsPerMinute": 101,
        "timestamps": {
          "startTime": "2023-05-01T11:30:00",
          "endTime": "2023-05-01T11:30:00"
        }
      },
      {
        "beatsPerMinute": 93,
        "timestamps": {
          "startTime": "2023-05-01T11:38:00",
          "endTime": "2023-05-01T11:38:00"
        }
      },
      {
        "beatsPerMinute": 110,
        "timestamps": {
          "startTime": "2023-05-01T11:46:00",
          "endTime": "2023-05-01T11:46:00"
        }
      },
      {
        "beatsPerMinute": 111,
        "timestamps": {
          "startTime": "2023-05-01T11:54:00",
          "endTime": "2023-05-01T11:54:00"
        }
      },
      {
        "beatsPerMinute": 117,
        "timestamps": {
          "startTime": "2023-05-01T12:03:00",
          "endTime": "2023-05-01T12:03:00"
        }
      },
      {
        "beatsPerMinute": 117,
        "timestamps": {
          "startTime": "2023-05-01T12:13:00",
          "endTime": "2023-05-01T12:13:00"
        }
      },
      {
        "beatsPerMinute": 103,
        "timestamps": {
          "startTime": "2023-05-01T12:19:00",
          "endTime": "2023-05-01T12:19:00"
        }
      },
      {
        "beatsPerMinute": 116,
        "timestamps": {
          "startTime": "2023-05-01T12:24:00",
          "endTime": "2023-05-01T12:24:00"
        }
      },
      {
        "beatsPerMinute": 107,
        "timestamps": {
          "startTime": "2023-05-01T12:27:00",
          "endTime": "2023-05-01T12:27:00"
        }
      },
      {
        "beatsPerMinute": 100,
        "timestamps": {
          "startTime": "2023-05-01T12:32:00",
          "endTime": "2023-05-01T12:32:00"
        }
      },
      {
        "beatsPerMinute": 104,
        "timestamps": {
          "startTime": "2023-05-01T12:36:00",
          "endTime": "2023-05-01T12:36:00"
        }
      },
      {
        "beatsPerMinute": 101,
        "timestamps": {
          "startTime": "2023-05-01T12:45:00",
          "endTime": "2023-05-01T12:45:00"
        }
      },
      {
        "beatsPerMinute": 95,
        "timestamps": {
          "startTime": "2023-05-01T12:53:00",
          "endTime": "2023-05-01T12:53:00"
        }
      },
      {
        "beatsPerMinute": 73,
        "timestamps": {
          "startTime": "2023-05-01T13:02:00",
          "endTime": "2023-05-01T13:02:00"
        }
      },
      {
        "beatsPerMinute": 81,
        "timestamps": {
          "startTime": "2023-05-01T13:10:00",
          "endTime": "2023-05-01T13:10:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T13:16:00",
          "endTime": "2023-05-01T13:16:00"
        }
      },
      {
        "beatsPerMinute": 86,
        "timestamps": {
          "startTime": "2023-05-01T13:23:00",
          "endTime": "2023-05-01T13:23:00"
        }
      },
      {
        "beatsPerMinute": 82,
        "timestamps": {
          "startTime": "2023-05-01T13:33:00",
          "endTime": "2023-05-01T13:33:00"
        }
      },
      {
        "beatsPerMinute": 82,
        "timestamps": {
          "startTime": "2023-05-01T13:40:00",
          "endTime": "2023-05-01T13:40:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T13:49:00",
          "endTime": "2023-05-01T13:49:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T13:53:00",
          "endTime": "2023-05-01T13:53:00"
        }
      },
      {
        "beatsPerMinute": 72,
        "timestamps": {
          "startTime": "2023-05-01T14:01:00",
          "endTime": "2023-05-01T14:01:00"
        }
      },
      {
        "beatsPerMinute": 90,
        "timestamps": {
          "startTime": "2023-05-01T14:06:00",
          "endTime": "2023-05-01T14:06:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T14:13:00",
          "endTime": "2023-05-01T14:13:00"
        }
      },
      {
        "beatsPerMinute": 79,
        "timestamps": {
          "startTime": "2023-05-01T14:19:00",
          "endTime": "2023-05-01T14:19:00"
        }
      },
      {
        "beatsPerMinute": 88,
        "timestamps": {
          "startTime": "2023-05-01T14:23:00",
          "endTime": "2023-05-01T14:23:00"
        }
      },
      {
        "beatsPerMinute": 78,
        "timestamps": {
          "startTime": "2023-05-01T14:31:00",
          "endTime": "2023-05-01T14:31:00"
        }
      },
      {
        "beatsPerMinute": 85,
        "timestamps": {
          "startTime": "2023-05-01T14:40:00",
          "endTime": "2023-05-01T14:40:00"
        }
      },
      {
        "beatsPerMinute": 81,
        "timestamps": {
          "startTime": "2023-05-01T14:44:00",
          "endTime": "2023-05-01T14:44:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T14:53:00",
          "endTime": "2023-05-01T14:53:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T14:59:00",
          "endTime": "2023-05-01T14:59:00"
        }
      },
      {
        "beatsPerMinute": 84,
        "timestamps": {
          "startTime": "2023-05-01T15:06:00",
          "endTime": "2023-05-01T15:06:00"
        }
      },
      {
        "beatsPerMinute": 72,
        "timestamps": {
          "startTime": "2023-05-01T15:11:00",
          "endTime": "2023-05-01T15:11:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T15:21:00",
          "endTime": "2023-05-01T15:21:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T15:30:00",
          "endTime": "2023-05-01T15:30:00"
        }
      },
      {
        "beatsPerMinute": 78,
        "timestamps": {
          "startTime": "2023-05-01T15:34:00",
          "endTime": "2023-05-01T15:34:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T15:44:00",
          "endTime": "2023-05-01T15:44:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T15:51:00",
          "endTime": "2023-05-01T15:51:00"
        }
      },
      {
        "beatsPerMinute": 80,
        "timestamps": {
          "startTime": "2023-05-01T15:54:00",
          "endTime": "2023-05-01T15:54:00"
        }
      },
      {
        "beatsPerMinute": 90,
        "timestamps": {
          "startTime": "2023-05-01T15:58:00",
          "endTime": "2023-05-01T15:58:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T16:06:00",
          "endTime": "2023-05-01T16:06:00"
        }
      },
      {
        "beatsPerMinute": 72,
        "timestamps": {
          "startTime": "2023-05-01T16:09:00",
          "endTime": "2023-05-01T16:09:00"
        }
      },
      {
        "beatsPerMinute": 75,
        "timestamps": {
          "startTime": "2023-05-01T16:18:00",
          "endTime": "2023-05-01T16:18:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T16:21:00",
          "endTime": "2023-05-01T16:21:00"
        }
      },
      {
        "beatsPerMinute": 85,
        "timestamps": {
          "startTime": "2023-05-01T16:28:00",
          "endTime": "2023-05-01T16:28:00"
        }
      },
      {
        "beatsPerMinute": 73,
        "timestamps": {
          "startTime": "2023-05-01T16:36:00",
          "endTime": "2023-05-01T16:36:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T16:45:00",
          "endTime": "2023-05-01T16:45:00"
        }
      },
      {
        "beatsPerMinute": 84,
        "timestamps": {
          "startTime": "2023-05-01T16:49:00",
          "endTime": "2023-05-01T16:49:00"
        }
      },
      {
        "beatsPerMinute": 72,
        "timestamps": {
          "startTime": "2023-05-01T16:59:00",
          "endTime": "2023-05-01T16:59:00"
        }
      },
      {
        "beatsPerMinute": 81,
        "timestamps": {
          "startTime": "2023-05-01T17:02:00",
          "endTime": "2023-05-01T17:02:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T17:11:00",
          "endTime": "2023-05-01T17:11:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T17:18:00",
          "endTime": "2023-05-01T17:18:00"
        }
      },
      {
        "beatsPerMinute": 88,
        "timestamps": {
          "startTime": "2023-05-01T17:26:00",
          "endTime": "2023-05-01T17:26:00"
        }
      },
      {
        "beatsPerMinute": 86,
        "timestamps": {
          "startTime": "2023-05-01T17:30:00",
          "endTime": "2023-05-01T17:30:00"
        }
      },
      {
        "beatsPerMinute": 80,
        "timestamps": {
          "startTime": "2023-05-01T17:35:00",
          "endTime": "2023-05-01T17:35:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T17:43:00",
          "endTime": "2023-05-01T17:43:00"
        }
      },
      {
        "beatsPerMinute": 78,
        "timestamps": {
          "startTime": "2023-05-01T17:53:00",
          "endTime": "2023-05-01T17:53:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T18:00:00",
          "endTime": "2023-05-01T18:00:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T18:04:00",
          "endTime": "2023-05-01T18:04:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T18:07:00",
          "endTime": "2023-05-01T18:07:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T18:11:00",
          "endTime": "2023-05-01T18:11:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T18:20:00",
          "endTime": "2023-05-01T18:20:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T18:30:00",
          "endTime": "2023-05-01T18:30:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T18:36:00",
          "endTime": "2023-05-01T18:36:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T18:40:00",
          "endTime": "2023-05-01T18:40:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T18:44:00",
          "endTime": "2023-05-01T18:44:00"
        }
      },
      {
        "beatsPerMinute": 74,
        "timestamps": {
          "startTime": "2023-05-01T18:54:00",
          "endTime": "2023-05-01T18:54:00"
        }
      },
      {
        "beatsPerMinute": 86,
        "timestamps": {
          "startTime": "2023-05-01T19:00:00",
          "endTime": "2023-05-01T19:00:00"
        }
      },
      {
        "beatsPerMinute": 90,
        "timestamps": {
          "startTime": "2023-05-01T19:06:00",
          "endTime": "2023-05-01T19:06:00"
        }
      },
      {
        "beatsPerMinute": 73,
        "timestamps": {
          "startTime": "2023-05-01T19:10:00",
          "endTime": "2023-05-01T19:10:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T19:19:00",
          "endTime": "2023-05-01T19:19:00"
        }
      },
      {
        "beatsPerMinute": 84,
        "timestamps": {
          "startTime": "2023-05-01T19:27:00",
          "endTime": "2023-05-01T19:27:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T19:33:00",
          "endTime": "2023-05-01T19:33:00"
        }
      },
      {
        "beatsPerMinute": 81,
        "timestamps": {
          "startTime": "2023-05-01T19:39:00",
          "endTime": "2023-05-01T19:39:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T19:48:00",
          "endTime": "2023-05-01T19:48:00"
        }
      },
      {
        "beatsPerMinute": 80,
        "timestamps": {
          "startTime": "2023-05-01T19:51:00",
          "endTime": "2023-05-01T19:51:00"
        }
      },
      {
        "beatsPerMinute": 81,
        "timestamps": {
          "startTime": "2023-05-01T20:00:00",
          "endTime": "2023-05-01T20:00:00"
        }
      },
      {
        "beatsPerMinute": 81,
        "timestamps": {
          "startTime": "2023-05-01T20:10:00",
          "endTime": "2023-05-01T20:10:00"
        }
      },
      {
        "beatsPerMinute": 88,
        "timestamps": {
          "startTime": "2023-05-01T20:14:00",
          "endTime": "2023-05-01T20:14:00"
        }
      },
      {
        "beatsPerMinute": 88,
        "timestamps": {
          "startTime": "2023-05-01T20:23:00",
          "endTime": "2023-05-01T20:23:00"
        }
      },
      {
        "beatsPerMinute": 75,
        "timestamps": {
          "startTime": "2023-05-01T20:29:00",
          "endTime": "2023-05-01T20:29:00"
        }
      },
      {
        "beatsPerMinute": 72,
        "timestamps": {
          "startTime": "2023-05-01T20:32:00",
          "endTime": "2023-05-01T20:32:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T20:42:00",
          "endTime": "2023-05-01T20:42:00"
        }
      },
      {
        "beatsPerMinute": 77,
        "timestamps": {
          "startTime": "2023-05-01T20:45:00",
          "endTime": "2023-05-01T20:45:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T20:49:00",
          "endTime": "2023-05-01T20:49:00"
        }
      },
      {
        "beatsPerMinute": 89,
        "timestamps": {
          "startTime": "2023-05-01T20:55:00",
          "endTime": "2023-05-01T20:55:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T21:01:00",
          "endTime": "2023-05-01T21:01:00"
        }
      },
      {
        "beatsPerMinute": 76,
        "timestamps": {
          "startTime": "2023-05-01T21:05:00",
          "endTime": "2023-05-01T21:05:00"
        }
      },
      {
        "beatsPerMinute": 71,
        "timestamps": {
          "startTime": "2023-05-01T21:09:00",
          "endTime": "2023-05-01T21:09:00"
        }
      },
      {
        "beatsPerMinute": 86,
        "timestamps": {
          "startTime": "2023-05-01T21:17:00",
          "endTime": "2023-05-01T21:17:00"
        }
      },
      {
        "beatsPerMinute": 83,
        "timestamps": {
          "startTime": "2023-05-01T21:21:00",
          "endTime": "2023-05-01T21:21:00"
        }
      },
      {
        "beatsPerMinute": 84,
        "timestamps": {
          "startTime": "2023-05-01T21:31:00",
          "endTime": "2023-05-01T21:31:00"
        }
      },
      {
        "beatsPerMinute": 75,
        "timestamps": {
          "startTime": "2023-05-01T21:41:00",
          "endTime": "2023-05-01T21:41:00"
        }
      },
      {
        "beatsPerMinute": 70,
        "timestamps": {
          "startTime": "2023-05-01T21:49:00",
          "endTime": "2023-05-01T21:49:00"
        }
      },
      {
        "beatsPerMinute": 80,
        "timestamps": {
          "startTime": "2023-05-01T21:56:00",
          "endTime": "2023-05-01T21:56:00"
        }
      }
    
    // Add the rest of your input data here...
  ];
  
  describe('Process data and write to file', () => {
    it('Calculates statistics and writes to output.json', () => {
      const results = {};
      inputData.forEach(item => {
        const startDate = new Date(item.timestamps.startTime);
        const day = startDate.toISOString().split('T')[0]; // Extract day from timestamp
  
        if (!results[day]) {
          results[day] = {
            date: day,
            min: Infinity,
            max: -Infinity,
            beats: [],
            latestDataTimestamp: null
          };
        }
  
        const beats = item.beatsPerMinute;
        results[day].min = Math.min(results[day].min, beats);
        results[day].max = Math.max(results[day].max, beats);
        results[day].beats.push(beats);
  
        if (!results[day].latestDataTimestamp || new Date(item.timestamps.startTime) > new Date(results[day].latestDataTimestamp)) {
          results[day].latestDataTimestamp = item.timestamps.startTime;
        }
      });
  
      for (const day in results) {
        results[day].median = median(results[day].beats);
      }
  
      const resultsArray = Object.values(results);
      const outputData = JSON.stringify(resultsArray, null, 2);
  
      // Write results to output.json using custom command
      cy.writeToFile('output.json', outputData).then(() => {
        cy.log('Output saved to output.json');
      }).catch(err => {
        throw new Error('Error writing to output.json: ' + err.message);
      });
    });
  });
  
  function median(values) {
    const sorted = values.slice().sort((a, b) => a - b);
    const middle = Math.floor(sorted.length / 2);
  
    if (sorted.length % 2 === 0) {
      return (sorted[middle - 1] + sorted[middle]) / 2;
    }
  
    return sorted[middle];
  }